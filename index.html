<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
       <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <title>Islamic Finance & Profit Calculator - Secure & Real-time</title>
    <meta name="description" content="Professional Islamic Finance Calculator with real-time gold, silver, and currency data. Shariah-compliant calculations for savings, investments, and profit sharing.">
    <meta name="keywords" content="Islamic finance, Halal investment, Gold prices, Silver rates, Mudarabah, Shariah compliant, Currency converter">
    <meta name="author" content="Rana Talha Majid">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Islamic Finance Calculator - Real-time & Secure">
    <meta property="og:description" content="Professional Shariah-compliant financial calculations with live market data">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ranatalhamajid1.github.io/islamic-finance-calculator">
    <meta property="og:image" content="https://ranatalhamajid1.github.io/islamic-finance-calculator/assets/preview.png">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Islamic Finance Calculator">
    <meta name="twitter:description" content="Professional Shariah-compliant financial calculations">
    <meta name="twitter:creator" content="@ranatalhamajid1">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png">
    
    <!-- CSS Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Islamic Finance Calculator",
        "description": "Professional Islamic Finance Calculator with real-time market data integration",
        "url": "https://ranatalhamajid1.github.io/islamic-finance-calculator",
        "author": {
            "@type": "Person",
            "name": "Rana Talha Majid",
            "email": "ranatalhamajid1@gmail.com"
        },
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        }
    }
    </script>
    
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">

 <!-- Security Notice for Development -->
    <div id="securityNotice" class="bg-green-500 text-white p-2 text-center text-sm hidden">
        <i class="fas fa-shield-alt mr-2"></i>
        <strong>Secure Connection:</strong> All vulnerabilities have been fixed. Server running with enhanced security.
        <button onclick="document.getElementById('securityNotice').style.display='none'" class="ml-4 bg-white text-green-500 px-2 py-1 rounded text-xs hover:bg-gray-100">
            ✓ Got it
        </button>
    </div>

    <!-- Navigation Header with Security Badge -->
    <nav class="bg-white dark:bg-gray-800 shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <i class="fas fa-mosque text-green-600 text-2xl mr-3"></i>
                    <h1 class="text-xl font-bold text-gray-900 dark:text-white" data-translate="app_title">
                        Islamic Finance Calculator
                    </h1>
                    <!-- Security & Status Indicators -->
                    <div class="ml-3 flex items-center space-x-2">
                        <div class="flex items-center">
                            <i class="fas fa-shield-alt text-green-500 text-sm mr-1" title="Secure & Vulnerability-free"></i>
                            <span class="text-xs text-gray-500 dark:text-gray-400">Secure</span>
                        </div>
                        <div class="flex items-center">
                            <div id="systemStatus" class="inline-block w-2 h-2 bg-gray-500 rounded-full"></div>
                            <span id="statusText" class="ml-1 text-xs text-gray-500 dark:text-gray-400">Connecting...</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Server Status -->
                    <button id="serverStatus" onclick="checkServerHealth()" class="px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md text-sm font-medium transition-colors">
                        <i class="fas fa-heartbeat mr-1"></i> Health Check
                    </button>
                    <!-- Rest of your existing navigation buttons -->
                    <button id="refreshData" onclick="manualRefresh()" class="px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium transition-colors">
                        <i class="fas fa-sync-alt mr-1"></i> Refresh
                    </button>
                    <button id="languageToggle" class="px-3 py-2 bg-gray-200 dark:bg-gray-700 rounded-md text-sm font-medium">
                        اردو
                    </button>
                    <button id="themeToggle" class="p-2 bg-gray-200 dark:bg-gray-700 rounded-md" title="Toggle theme">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Security & Performance Status Bar -->
    <div class="bg-gradient-to-r from-green-500 to-blue-500 text-white p-2 text-center text-sm">
        <div class="max-w-7xl mx-auto flex justify-center items-center space-x-6">
            <div class="flex items-center">
                <i class="fas fa-lock mr-1"></i>
                <span>SSL Secured</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-tachometer-alt mr-1"></i>
                <span>Optimized Performance</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-database mr-1"></i>
                <span>Real-time Data</span>
            </div>
            <div class="flex items-center">
                <i class="fas fa-star-and-crescent mr-1"></i>
                <span>Shariah Compliant</span>
            </div>
        </div>
    </div>

    <!-- CORS Fix Notice -->
    <div id="corsNotice" class="bg-yellow-500 text-black p-3 text-center text-sm">
        <i class="fas fa-exclamation-triangle mr-2"></i>
        <strong>CORS Issue Detected:</strong> Please run this from a local server or deploy to fix API connectivity.
        <button onclick="startLocalServer()" class="ml-4 bg-white px-3 py-1 rounded text-black font-medium hover:bg-gray-100">
            <i class="fas fa-play mr-1"></i>Show Solution
        </button>
        <button onclick="document.getElementById('corsNotice').style.display='none'" class="ml-2 text-black hover:text-gray-700" title="Close CORS Notice">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- Navigation Header -->
    <nav class="bg-white dark:bg-gray-800 shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <i class="fas fa-mosque text-green-600 text-2xl mr-3"></i>
                    <h1 class="text-xl font-bold text-gray-900 dark:text-white" data-translate="app_title">
                        Islamic Finance Calculator
                    </h1>
                    <!-- Live Data Status Indicator -->
                    <div class="ml-3 flex items-center">
                        <div id="systemStatus" class="inline-block w-2 h-2 bg-red-500 rounded-full"></div>
                        <span class="ml-1 text-xs text-gray-500 dark:text-gray-400">CORS Blocked</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Setup Button -->
                    <button id="setupButton" onclick="showSetupInstructions()" class="px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md text-sm font-medium transition-colors">
                        <i class="fas fa-cog mr-1"></i> Fix Setup
                    </button>
                    <!-- Debug Toggle -->
                    <button id="debugToggle" onclick="toggleDebugMode()" class="px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium transition-colors">
                        <i class="fas fa-bug mr-1"></i> Debug
                    </button>
                    <!-- Refresh Button -->
                    <button id="refreshData" onclick="manualRefresh()" class="px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium transition-colors">
                        <i class="fas fa-sync-alt mr-1"></i> Refresh
                    </button>
                    <!-- Language Toggle -->
                    <button id="languageToggle" class="px-3 py-2 bg-gray-200 dark:bg-gray-700 rounded-md text-sm font-medium">
                        اردو
                    </button>
                    <!-- Theme Toggle -->
                    <button id="themeToggleNav" class="p-2 bg-gray-200 dark:bg-gray-700 rounded-md" title="Toggle theme">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- CORS Fix Instructions Modal -->
    <div id="setupModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-center p-6 border-b dark:border-gray-700">
                    <h2 class="text-xl font-bold text-gray-900 dark:text-white">
                        <i class="fas fa-tools mr-2 text-green-600"></i>Fix CORS Issue & Enable Live Data
                    </h2>
                    <button onclick="closeSetupModal()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200" aria-label="Close modal" title="Close">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="p-6">
                    <div class="bg-red-50 dark:bg-red-900 border-l-4 border-red-500 p-4 mb-6">
                        <div class="flex">
                            <i class="fas fa-exclamation-triangle text-red-500 mr-3 mt-1"></i>
                            <div>
                                <h3 class="text-red-800 dark:text-red-200 font-medium">CORS Policy Issue Detected</h3>
                                <p class="text-red-700 dark:text-red-300 text-sm mt-1">
                                    Your browser is blocking API requests because you're opening the HTML file directly. 
                                    This is a security feature that prevents local files from accessing external APIs.
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Solution 1: Local Server -->
                        <div class="bg-green-50 dark:bg-green-900 p-6 rounded-lg">
                            <h3 class="text-green-800 dark:text-green-200 font-bold mb-3">
                                <i class="fas fa-server mr-2"></i>Solution 1: Local Server (Recommended)
                            </h3>
                            <div class="space-y-3 text-sm">
                                <div>
                                    <h4 class="font-medium text-green-700 dark:text-green-300">Using Python:</h4>
                                    <code class="block bg-gray-800 text-green-400 p-2 rounded mt-1">
                                        # Navigate to your project folder, then:<br>
                                        python -m http.server 8000<br>
                                        # Then open: http://localhost:8000
                                    </code>
                                </div>
                                <div>
                                    <h4 class="font-medium text-green-700 dark:text-green-300">Using Node.js:</h4>
                                    <code class="block bg-gray-800 text-green-400 p-2 rounded mt-1">
                                        npx http-server<br>
                                        # Or: npm install -g http-server
                                    </code>
                                </div>
                                <div>
                                    <h4 class="font-medium text-green-700 dark:text-green-300">Using Live Server (VS Code):</h4>
                                    <p class="text-green-600 dark:text-green-400">Install "Live Server" extension and right-click → "Open with Live Server"</p>
                                </div>
                            </div>
                        </div>

                        <!-- Solution 2: GitHub Pages -->
                        <div class="bg-blue-50 dark:bg-blue-900 p-6 rounded-lg">
                            <h3 class="text-blue-800 dark:text-blue-200 font-bold mb-3">
                                <i class="fab fa-github mr-2"></i>Solution 2: GitHub Pages
                            </h3>
                            <div class="space-y-2 text-sm text-blue-700 dark:text-blue-300">
                                <p>1. Create a GitHub repository</p>
                                <p>2. Upload your files</p>
                                <p>3. Enable Pages in Settings</p>
                                <p>4. Access via: username.github.io/repo-name</p>
                                <button onclick="openGitHubPages()" class="mt-3 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                                    <i class="fab fa-github mr-2"></i>Open GitHub
                                </button>
                            </div>
                        </div>

                        <!-- Solution 3: Netlify -->
                        <div class="bg-purple-50 dark:bg-purple-900 p-6 rounded-lg">
                            <h3 class="text-purple-800 dark:text-purple-200 font-bold mb-3">
                                <i class="fas fa-cloud mr-2"></i>Solution 3: Netlify Drop
                            </h3>
                            <div class="space-y-2 text-sm text-purple-700 dark:text-purple-300">
                                <p>1. Go to netlify.com</p>
                                <p>2. Drag & drop your project folder</p>
                                <p>3. Get instant deployment</p>
                                <p>4. Free custom domain included</p>
                                <button onclick="openNetlify()" class="mt-3 bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">
                                    <i class="fas fa-external-link-alt mr-2"></i>Open Netlify
                                </button>
                            </div>
                        </div>

                        <!-- Solution 4: Browser Settings (Not Recommended) -->
                        <div class="bg-yellow-50 dark:bg-yellow-900 p-6 rounded-lg">
                            <h3 class="text-yellow-800 dark:text-yellow-200 font-bold mb-3">
                                <i class="fas fa-exclamation-triangle mr-2"></i>Solution 4: Disable CORS (Not Recommended)
                            </h3>
                            <div class="space-y-2 text-sm text-yellow-700 dark:text-yellow-300">
                                <p><strong>Chrome:</strong> Close all instances, then run:</p>
                                <code class="block bg-gray-800 text-yellow-400 p-2 rounded text-xs">
                                    chrome --disable-web-security --user-data-dir="c:/chrome-dev-session"
                                </code>
                                <p class="text-red-600 dark:text-red-400 font-medium">⚠️ Security Risk: Only for testing!</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                        <h4 class="font-medium text-gray-900 dark:text-white mb-2">Current Status:</h4>
                        <div class="space-y-1 text-sm">
                            <div class="flex justify-between">
                                <span>Protocol:</span>
                                <span id="currentProtocol" class="font-mono text-red-600">file://</span>
                            </div>
                            <div class="flex justify-between">
                                <span>CORS Status:</span>
                                <span class="text-red-600">❌ Blocked</span>
                            </div>
                            <div class="flex justify-between">
                                <span>API Access:</span>
                                <span class="text-red-600">❌ Failed</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Debug Panel -->
    <div id="debugPanel" class="fixed bottom-4 right-4 w-96 bg-gray-900 text-white rounded-lg shadow-lg z-40 hidden">
        <div class="bg-gray-800 p-3 rounded-t-lg flex justify-between items-center">
            <h3 class="font-medium">Debug Panel</h3>
            <button onclick="toggleDebugPanel()" class="text-gray-400 hover:text-white" aria-label="Minimize Debug Panel" title="Minimize Debug Panel">
                <i class="fas fa-minus"></i>
            </button>
        </div>
        <div class="p-3 max-h-60 overflow-y-auto text-xs font-mono">
            <div class="space-y-2">
                <div>Protocol: <span id="debugProtocol" class="text-red-400">file://</span></div>
                <div>CORS Status: <span class="text-red-400">Blocked</span></div>
                <div>API Status: <span class="text-red-400">Failed</span></div>
                <div>Last Attempt: <span id="debugLastAttempt" class="text-yellow-400">Never</span></div>
            </div>
            <div class="mt-3 pt-3 border-t border-gray-700">
                <div class="flex space-x-2 mb-2">
                    <button onclick="testConnection()" class="px-2 py-1 bg-blue-600 rounded text-xs">Test API</button>
                    <button onclick="showSetupInstructions()" class="px-2 py-1 bg-green-600 rounded text-xs">Fix CORS</button>
                </div>
                <div id="debugLogs" class="text-xs space-y-1 max-h-32 overflow-y-auto">
                    <div class="text-red-400">[ERROR] CORS policy blocking API requests</div>
                    <div class="text-yellow-400">[WARNING] Using demo data as fallback</div>
                    <div class="text-blue-400">[INFO] Run from local server to fix</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Rest of your existing HTML content -->
    <!-- Main Dashboard -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- CORS Warning Banner -->
        <div class="bg-orange-100 border-l-4 border-orange-500 p-4 mb-6">
            <div class="flex">
                <div class="flex-shrink-0">
                    <i class="fas fa-exclamation-triangle text-orange-500"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-orange-700">
                        <strong>Demo Mode Active:</strong> API requests are blocked due to CORS policy. 
                        <button onclick="showSetupInstructions()" class="underline font-medium hover:text-orange-800">
                            Click here to enable live data →
                        </button>
                    </p>
                </div>
            </div>
        </div>

        <!-- Dashboard Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Savings Calculator Card -->
            <div class="dashboard-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer relative" onclick="openCalculator('savings')">
                <div class="live-indicator absolute top-2 right-2 w-2 h-2 bg-red-400 rounded-full" title="Demo data - CORS blocked"></div>
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white" data-translate="savings_title">
                            Savings Calculator
                        </h3>
                        <p class="text-gray-600 dark:text-gray-400" data-translate="savings_desc">
                            Islamic & Conventional
                        </p>
                        <div class="mt-2">
                            <span class="halal-badge">
                                <i class="fas fa-check-circle mr-1"></i>Halal
                            </span>
                        </div>
                    </div>
                    <i class="fas fa-piggy-bank text-3xl text-green-500"></i>
                </div>
            </div>

            <!-- Mutual Funds Card -->
            <div class="dashboard-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer relative" onclick="openCalculator('mutual-funds')">
                <div class="live-indicator absolute top-2 right-2 w-2 h-2 bg-red-400 rounded-full" title="Demo data - CORS blocked"></div>
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white" data-translate="mutual_funds_title">
                            Mutual Funds
                        </h3>
                        <p class="text-gray-600 dark:text-gray-400" data-translate="mutual_funds_desc">
                            NAV Growth Tracker
                        </p>
                        <div class="mt-2">
                            <span class="halal-badge">
                                <i class="fas fa-check-circle mr-1"></i>Islamic Funds
                            </span>
                        </div>
                    </div>
                    <i class="fas fa-chart-line text-3xl text-blue-500"></i>
                </div>
            </div>

            <!-- Gold & Silver Card -->
            <div class="dashboard-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer relative" onclick="openCalculator('gold-silver')">
                <div class="live-indicator absolute top-2 right-2 w-2 h-2 bg-red-400 rounded-full" title="Demo data - CORS blocked"></div>
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white" data-translate="gold_silver_title">
                            Gold & Silver
                        </h3>
                        <p class="text-gray-600 dark:text-gray-400" data-translate="gold_silver_desc">
                            Investment Tracker
                        </p>
                        <div class="mt-2">
                            <span class="halal-badge">
                                <i class="fas fa-check-circle mr-1"></i>Halal
                            </span>
                        </div>
                    </div>
                    <i class="fas fa-coins text-3xl text-yellow-500"></i>
                </div>
            </div>

            <!-- Currency Converter Card -->
            <div class="dashboard-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow cursor-pointer relative" onclick="openCalculator('currency')">
                <div class="live-indicator absolute top-2 right-2 w-2 h-2 bg-red-400 rounded-full" title="Demo data - CORS blocked"></div>
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white" data-translate="currency_title">
                            Currency Converter
                        </h3>
                        <p class="text-gray-600 dark:text-gray-400" data-translate="currency_desc">
                            Real-time Rates
                        </p>
                        <div class="mt-2">
                            <span class="haram-badge">
                                <i class="fas fa-exclamation-triangle mr-1"></i>Currency Trading
                            </span>
                        </div>
                    </div>
                    <i class="fas fa-exchange-alt text-3xl text-purple-500"></i>
                </div>
            </div>
        </div>

        <!-- Live Data Display (Demo Mode) -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white" data-translate="live_data_title">
                    Live Market Data (Demo Mode)
                </h3>
                <div class="flex items-center text-sm text-red-500 dark:text-red-400">
                    <i class="fas fa-exclamation-triangle mr-1"></i>
                    <span>CORS Blocked - Demo Data</span>
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-md">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium text-gray-700 dark:text-gray-300" data-translate="usd_pkr">USD/PKR</h4>
                            <p class="text-xl font-bold text-green-600">₨281.50</p>
                        </div>
                        <i class="fas fa-dollar-sign text-green-500"></i>
                    </div>
                    <div class="text-sm mt-1 text-gray-500">Demo Data</div>
                </div>
                <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-md">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium text-gray-700 dark:text-gray-300" data-translate="gold_price">Gold (per tola)</h4>
                            <p class="text-xl font-bold text-yellow-600">₨185,000</p>
                        </div>
                        <i class="fas fa-coins text-yellow-500"></i>
                    </div>
                    <div class="text-sm mt-1 text-gray-500">Demo Data</div>
                </div>
                <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-md">
                    <div class="flex justify-between items-start">
                        <div>
                            <h4 class="font-medium text-gray-700 dark:text-gray-300" data-translate="silver_price">Silver (per tola)</h4>
                            <p class="text-xl font-bold text-gray-400">₨2,180</p>
                        </div>
                        <i class="fas fa-medal text-gray-400"></i>
                    </div>
                    <div class="text-sm mt-1 text-gray-500">Demo Data</div>
                </div>
            </div>
        </div>
    </div>

 <script>
        // Security and health check functions
        async function checkServerHealth() {
            try {
                const response = await fetch('/health');
                const health = await response.json();
                
                alert(`Server Health Report:
Status: ${health.status}
Uptime: ${health.uptime}
Memory: ${health.memory.used}/${health.memory.total}
Environment: ${health.environment}
Security: ${health.security}
Timestamp: ${health.timestamp}`);
                
            } catch (error) {
                alert('Health check failed: ' + error.message);
            }
        }
        
        // Show security notice on load
        document.addEventListener('DOMContentLoaded', function() {
            // Show security notice for 5 seconds
            document.getElementById('securityNotice').classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('securityNotice').style.display = 'none';
            }, 5000);
            
            // Update status indicators
            updateSecurityStatus();
        });
        
        function updateSecurityStatus() {
            const protocol = window.location.protocol;
            const isSecure = protocol === 'https:' || window.location.hostname === 'localhost';
            
            if (isSecure) {
                document.getElementById('systemStatus').className = 'inline-block w-2 h-2 bg-green-500 rounded-full pulse';
                document.getElementById('statusText').textContent = 'Secure';
            } else {
                document.getElementById('systemStatus').className = 'inline-block w-2 h-2 bg-yellow-500 rounded-full';
                document.getElementById('statusText').textContent = 'Local Dev';
            }
        }
        
        function manualRefresh() {
            // Your existing refresh logic
            console.log('Refreshing data...');
        }
    </script>

    <script src="js/main.js"></script>
    <script src="js/calculators.js"></script>
    <script src="js/language.js"></script>
    <script src="js/export.js"></script>

    <script>
        // CORS-aware version of the calculator
        
        // Detect current protocol and show appropriate warnings
        function detectProtocol() {
            const protocol = window.location.protocol;
            const isFile = protocol === 'file:';
            const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            
            document.getElementById('currentProtocol').textContent = protocol;
            document.getElementById('debugProtocol').textContent = protocol;
            
            if (isFile) {
                document.getElementById('corsNotice').style.display = 'block';
                document.getElementById('systemStatus').className = 'inline-block w-2 h-2 bg-red-500 rounded-full';
                document.getElementById('systemStatus').nextElementSibling.textContent = 'CORS Blocked';
            } else if (isLocalhost) {
                document.getElementById('corsNotice').style.display = 'none';
                document.getElementById('systemStatus').className = 'inline-block w-2 h-2 bg-green-500 rounded-full';
                document.getElementById('systemStatus').nextElementSibling.textContent = 'Local Server';
            }
        }

        function showSetupInstructions() {
            document.getElementById('setupModal').classList.remove('hidden');
        }

        function closeSetupModal() {
            document.getElementById('setupModal').classList.add('hidden');
        }

        function toggleDebugMode() {
            const panel = document.getElementById('debugPanel');
            panel.classList.toggle('hidden');
        }

        function toggleDebugPanel() {
            const panel = document.getElementById('debugPanel');
            panel.classList.toggle('hidden');
        }

        function testConnection() {
            const logs = document.getElementById('debugLogs');
            const timestamp = new Date().toLocaleTimeString();
            logs.innerHTML += `<div class="text-blue-400">[${timestamp}] Testing connection...</div>`;
            
            if (window.location.protocol === 'file:') {
                logs.innerHTML += `<div class="text-red-400">[${timestamp}] CORS policy prevents API access from file:// protocol</div>`;
            } else {
                logs.innerHTML += `<div class="text-green-400">[${timestamp}] Protocol ${window.location.protocol} should work</div>`;
            }
            
            document.getElementById('debugLastAttempt').textContent = timestamp;
        }

        function manualRefresh() {
            if (window.location.protocol === 'file:') {
                alert('Please run from a local server to enable live data updates.');
                showSetupInstructions();
            } else {
                // Your existing refresh logic
                console.log('Refresh would work from proper server');
            }
        }

        function startLocalServer() {
            showSetupInstructions();
        }

        function openGitHubPages() {
            window.open('https://pages.github.com/', '_blank');
        }

        function openNetlify() {
            window.open('https://app.netlify.com/drop', '_blank');
        }

        // Calculator placeholder functions
        function openCalculator(type) {
            alert(`${type} calculator would open here. This works even with CORS issues!`);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            detectProtocol();
            
            // Show setup instructions automatically if using file:// protocol
            if (window.location.protocol === 'file:') {
                setTimeout(() => {
                    showSetupInstructions();
                }, 2000);
            }
        });
    </script>
        <script>
// Set your Apps Script URL here (replace with your actual URL)
document.addEventListener('DOMContentLoaded', function() {
    if (window.calculatorApp) {
        window.calculatorApp.appsScriptUrl = 'https://script.google.com/macros/s/AKfycbwO3rDwidosqqH7isk-Mu0lyF03UKi9P0gsAwQ5QvJ9QZIFcoK3VbJNPRyfQLqX9-3g/exec';
        window.calculatorApp.loadInitialData();
    }
});
        </script>
</body>
</html>